montageDefine("6e7bb6e","extensions/common/js/services/follow-me",{dependencies:[],factory:function(){define(["bluebird"],function(e){var n=function(n,t){this._url=n,this._lock=t,this._started=!1,this._lockInterval=null;var o=this;return this._lockTab=function(){o.isStarted()&&o._tab.id?chrome.tabs.get(o._tab.id,function(e){e?chrome.tabs.update(o._tab.id,{highlighted:!0}):o.stop()}):o.stop()},this._lockWindowFocus=function(){o.isStarted()&&o._tab.windowId?chrome.windows.get(o._tab.windowId,function(e){e?chrome.windows.update(o._tab.windowId,{focused:!0,state:"fullscreen"}):o.stop()}):o.stop()},this._unlockWindow=function(){o._tab.windowId&&chrome.windows.get(o._tab.windowId,function(e){e&&chrome.windows.update(o._tab.windowId,{state:"normal"})})},this.start=function(){return new e(function(e){o._started=!0,o._lockTab(),o._lockWindowFocus(),o._lock&&(o._lockInterval=setInterval(function(){o._lockWindowFocus()},125),chrome.tabs.onActiveChanged.addListener(o._lockTab),chrome.windows.onFocusChanged.addListener(o._lockWindowFocus)),e()})},this.stop=function(){return new e(function(e){clearInterval(o._lockInterval),o._lockInterval=null,chrome.tabs.onActiveChanged.removeListener(o._lockTab),chrome.windows.onFocusChanged.removeListener(o._lockWindowFocus),o._unlockWindow(),o._started=!1,e()})},this.isStarted=function(){return this._started},new e(function(e){chrome.tabs.query({url:n.split("#")[0]},function(t){t.length>0?(o._tab=t.filter(function(e){return e.url==n})[0],e(o)):chrome.tabs.create({url:n,active:!0},function(n){o._tab=n,e(o)})})})};return n})}});